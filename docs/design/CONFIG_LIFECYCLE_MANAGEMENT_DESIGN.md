# é…ç½®ç”Ÿå‘½å‘¨æœŸç®¡ç†ç³»ç»Ÿ - è¯¦ç»†è®¾è®¡æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-01-31  
**ç›®æ ‡è¯»è€…**: æ–°æ‰‹å¼€å‘è€…  
**é¢„è®¡å®æ–½æ—¶é—´**: 2-3å‘¨  

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#1-ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒéœ€æ±‚](#2-æ ¸å¿ƒéœ€æ±‚)
3. [ç³»ç»Ÿæ¶æ„](#3-ç³»ç»Ÿæ¶æ„)
4. [æ•°æ®æ¨¡å‹è®¾è®¡](#4-æ•°æ®æ¨¡å‹è®¾è®¡)
5. [æ ¸å¿ƒç»„ä»¶è®¾è®¡](#5-æ ¸å¿ƒç»„ä»¶è®¾è®¡)
6. [APIæ¥å£è®¾è®¡](#6-apiæ¥å£è®¾è®¡)
7. [å®æ–½è®¡åˆ’](#7-å®æ–½è®¡åˆ’)
8. [æµ‹è¯•ç­–ç•¥](#8-æµ‹è¯•ç­–ç•¥)
9. [ä»£ç æ¨¡æ¿](#9-ä»£ç æ¨¡æ¿)

---

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 èƒŒæ™¯

å½“å‰ dev-env é¡¹ç›®å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
- âŒ æ— æ³•è·Ÿè¸ªé…ç½®ç‰ˆæœ¬
- âŒ å‡çº§æ—¶ç”¨æˆ·é…ç½®å¯èƒ½è¢«è¦†ç›–
- âŒ ç¼ºå°‘é…ç½®è¿ç§»å·¥å…·
- âŒ é…ç½®é”™è¯¯æ—¶æ— æ³•è‡ªåŠ¨æ¢å¤

### 1.2 ç›®æ ‡

æ„å»ºä¸€ä¸ªå®Œæ•´çš„é…ç½®ç”Ÿå‘½å‘¨æœŸç®¡ç†ç³»ç»Ÿï¼Œå®ç°ï¼š
- âœ… é…ç½®ç‰ˆæœ¬åŒ–ç®¡ç†
- âœ… æ™ºèƒ½é…ç½®è¿ç§»
- âœ… ç”¨æˆ·è‡ªå®šä¹‰ä¿æŠ¤
- âœ… è‡ªåŠ¨å¥åº·æ£€æŸ¥
- âœ… é”™è¯¯è‡ªåŠ¨æ¢å¤

### 1.3 è®¾è®¡åŸåˆ™

1. **ç‰ˆæœ¬åŒ–ä¼˜å…ˆ** - æ‰€æœ‰é…ç½®éƒ½æœ‰æ˜ç¡®ç‰ˆæœ¬å·
2. **ç”¨æˆ·å‹å¥½** - è‡ªåŠ¨åŒ–å¤„ç†ï¼Œæœ€å°åŒ–ç”¨æˆ·å¹²é¢„
3. **å®‰å…¨ç¬¬ä¸€** - å˜æ›´å‰å¤‡ä»½ï¼Œå¤±è´¥è‡ªåŠ¨æ¢å¤
4. **å¯è¿½æº¯æ€§** - æ‰€æœ‰å˜æ›´éƒ½æœ‰å®Œæ•´è®°å½•
5. **å‘åå…¼å®¹** - ä¸ç ´åç°æœ‰åŠŸèƒ½

---

## 2. æ ¸å¿ƒéœ€æ±‚

### 2.1 åŠŸèƒ½éœ€æ±‚

#### FR1: ç‰ˆæœ¬ç®¡ç†
- FR1.1: è®°å½•å½“å‰é…ç½®ç‰ˆæœ¬
- FR1.2: è·Ÿè¸ªé…ç½®å˜æ›´å†å²
- FR1.3: æ”¯æŒç‰ˆæœ¬å›æ»š

#### FR2: é…ç½®è¿ç§»
- FR2.1: æ£€æµ‹é…ç½®ç‰ˆæœ¬å·®å¼‚
- FR2.2: è‡ªåŠ¨æ‰§è¡Œè¿ç§»è„šæœ¬
- FR2.3: ä¿ç•™ç”¨æˆ·è‡ªå®šä¹‰é…ç½®

#### FR3: å¥åº·æ£€æŸ¥
- FR3.1: å¯åŠ¨æ—¶é…ç½®éªŒè¯
- FR3.2: è¯­æ³•é”™è¯¯æ£€æµ‹
- FR3.3: æ’ä»¶å†²çªæ£€æµ‹

#### FR4: é”™è¯¯æ¢å¤
- FR4.1: é…ç½®åŠ è½½å¤±è´¥è‡ªåŠ¨å›æ»š
- FR4.2: å®‰å…¨æ¨¡å¼å¯åŠ¨
- FR4.3: é”™è¯¯è¯Šæ–­å’Œä¿®å¤å»ºè®®

### 2.2 éåŠŸèƒ½éœ€æ±‚

- **æ€§èƒ½**: ç‰ˆæœ¬æ£€æŸ¥ < 50ms
- **å¯é æ€§**: 99.9% é…ç½®æ¢å¤æˆåŠŸç‡
- **å¯ç”¨æ€§**: æ–°æ‰‹å¯åœ¨ 30 åˆ†é’Ÿå†…ç†è§£å’Œä½¿ç”¨
- **å¯ç»´æŠ¤æ€§**: ä»£ç æ³¨é‡Šè¦†ç›–ç‡ > 80%

---

## 3. ç³»ç»Ÿæ¶æ„

### 3.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  é…ç½®ç”Ÿå‘½å‘¨æœŸç®¡ç†ç³»ç»Ÿ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           ç”¨æˆ·æ¥å£å±‚ (CLI Interface)                  â”‚   â”‚
â”‚  â”‚  - zsh_config_manager.sh (ä¸»å…¥å£)                    â”‚   â”‚
â”‚  â”‚  - å‘½ä»¤: version, migrate, health, rollback          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           æ ¸å¿ƒæœåŠ¡å±‚ (Core Services)                  â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ ç‰ˆæœ¬ç®¡ç†æœåŠ¡  â”‚  â”‚ è¿ç§»ç®¡ç†æœåŠ¡  â”‚  â”‚ å¥åº·æ£€æŸ¥  â”‚ â”‚   â”‚
â”‚  â”‚  â”‚VersionMgr    â”‚  â”‚ MigrationMgr â”‚  â”‚ HealthChk â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ å¤‡ä»½æ¢å¤æœåŠ¡  â”‚  â”‚ é…ç½®éªŒè¯æœåŠ¡  â”‚                â”‚   â”‚
â”‚  â”‚  â”‚ BackupMgr    â”‚  â”‚ ValidatorSvc â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           æ•°æ®è®¿é—®å±‚ (Data Access)                    â”‚   â”‚
â”‚  â”‚  - ç‰ˆæœ¬æ•°æ®åº“ (version.db)                           â”‚   â”‚
â”‚  â”‚  - è¿ç§»è„šæœ¬åº“ (migrations/)                          â”‚   â”‚
â”‚  â”‚  - é…ç½®å¤‡ä»½åº“ (backups/)                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ç›®å½•ç»“æ„

```
dev-env/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ zsh_config_manager.sh          # ä¸»ç®¡ç†å·¥å…· (æ–°å»º)
â”‚   â”œâ”€â”€ lib_version.sh                 # ç‰ˆæœ¬ç®¡ç†åº“ (æ–°å»º)
â”‚   â”œâ”€â”€ lib_migration.sh               # è¿ç§»ç®¡ç†åº“ (æ–°å»º)
â”‚   â”œâ”€â”€ lib_health.sh                  # å¥åº·æ£€æŸ¥åº“ (æ–°å»º)
â”‚   â””â”€â”€ lib_backup.sh                  # å¤‡ä»½æ¢å¤åº“ (æ–°å»º)
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ .zshrc.version                 # ç‰ˆæœ¬æ ‡è®°æ–‡ä»¶ (æ–°å»º)
â”‚   â””â”€â”€ migrations/                    # è¿ç§»è„šæœ¬ç›®å½• (æ–°å»º)
â”‚       â”œâ”€â”€ 001_initial.sh
â”‚       â”œâ”€â”€ 002_add_template_system.sh
â”‚       â””â”€â”€ README.md
â”œâ”€â”€ data/                              # æ•°æ®ç›®å½• (æ–°å»º)
â”‚   â”œâ”€â”€ version.db                     # ç‰ˆæœ¬æ•°æ®åº“
â”‚   â”œâ”€â”€ migration_history.log          # è¿ç§»å†å²
â”‚   â””â”€â”€ health_check.log               # å¥åº·æ£€æŸ¥æ—¥å¿—
â””â”€â”€ backups/                           # å¤‡ä»½ç›®å½• (æ–°å»º)
    â””â”€â”€ config-YYYYMMDD-HHMMSS/
```

---

## 4. æ•°æ®æ¨¡å‹è®¾è®¡

### 4.1 ç‰ˆæœ¬ä¿¡æ¯æ¨¡å‹

**æ–‡ä»¶**: `config/.zshrc.version`

```bash
# ZSH Configuration Version File
# Auto-generated - DO NOT EDIT MANUALLY

VERSION="2.2.0"
BUILD_DATE="2026-01-31"
INSTALL_DATE="2026-01-31 10:30:00"
LAST_MIGRATION="002_add_template_system"
USER_CUSTOMIZATIONS="true"
CUSTOM_CONFIG_HASH="a1b2c3d4e5f6"
```

### 4.2 è¿ç§»å†å²æ¨¡å‹

**æ–‡ä»¶**: `data/migration_history.log`

```
# Migration History Log
# Format: TIMESTAMP|MIGRATION_ID|FROM_VERSION|TO_VERSION|STATUS|DURATION

2026-01-31 10:30:15|001_initial|0.0.0|2.0.0|SUCCESS|1.2s
2026-01-31 10:30:17|002_add_template_system|2.0.0|2.2.0|SUCCESS|0.8s
```

### 4.3 å¥åº·æ£€æŸ¥æ¨¡å‹

**æ–‡ä»¶**: `data/health_check.log`

```json
{
  "timestamp": "2026-01-31T10:30:00Z",
  "version": "2.2.0",
  "checks": [
    {
      "name": "syntax_check",
      "status": "PASS",
      "message": "Configuration syntax is valid"
    },
    {
      "name": "plugin_check",
      "status": "PASS",
      "message": "All plugins loaded successfully"
    },
    {
      "name": "dependency_check",
      "status": "WARN",
      "message": "Optional dependency 'fzf' not found"
    }
  ],
  "overall_status": "HEALTHY"
}
```

---

## 5. æ ¸å¿ƒç»„ä»¶è®¾è®¡

### 5.1 ç‰ˆæœ¬ç®¡ç†æœåŠ¡ (lib_version.sh)

#### åŠŸèƒ½èŒè´£
- è¯»å–å’Œæ›´æ–°ç‰ˆæœ¬ä¿¡æ¯
- æ¯”è¾ƒç‰ˆæœ¬å·
- ç”Ÿæˆç‰ˆæœ¬æŠ¥å‘Š

#### æ ¸å¿ƒå‡½æ•°

```bash
# è·å–å½“å‰é…ç½®ç‰ˆæœ¬
get_current_version()

# è®¾ç½®é…ç½®ç‰ˆæœ¬
set_version(version, build_date)

# æ¯”è¾ƒä¸¤ä¸ªç‰ˆæœ¬å·
compare_versions(version1, version2)

# æ£€æŸ¥æ˜¯å¦éœ€è¦è¿ç§»
needs_migration()

# ç”Ÿæˆç‰ˆæœ¬æŠ¥å‘Š
generate_version_report()
```

### 5.2 è¿ç§»ç®¡ç†æœåŠ¡ (lib_migration.sh)

#### åŠŸèƒ½èŒè´£
- æ£€æµ‹éœ€è¦æ‰§è¡Œçš„è¿ç§»
- æ‰§è¡Œè¿ç§»è„šæœ¬
- è®°å½•è¿ç§»å†å²
- å¤„ç†è¿ç§»å¤±è´¥

#### æ ¸å¿ƒå‡½æ•°

```bash
# è·å–å¾…æ‰§è¡Œçš„è¿ç§»åˆ—è¡¨
get_pending_migrations()

# æ‰§è¡Œå•ä¸ªè¿ç§»
execute_migration(migration_id)

# æ‰§è¡Œæ‰€æœ‰å¾…æ‰§è¡Œè¿ç§»
run_migrations()

# å›æ»šè¿ç§»
rollback_migration(migration_id)

# è®°å½•è¿ç§»å†å²
log_migration(migration_id, status, duration)
```

### 5.3 å¥åº·æ£€æŸ¥æœåŠ¡ (lib_health.sh)

#### åŠŸèƒ½èŒè´£
- é…ç½®è¯­æ³•æ£€æŸ¥
- æ’ä»¶çŠ¶æ€æ£€æŸ¥
- ä¾èµ–å·¥å…·æ£€æŸ¥
- ç”Ÿæˆå¥åº·æŠ¥å‘Š

#### æ ¸å¿ƒå‡½æ•°

```bash
# æ‰§è¡Œå®Œæ•´å¥åº·æ£€æŸ¥
run_health_check()

# è¯­æ³•æ£€æŸ¥
check_syntax()

# æ’ä»¶æ£€æŸ¥
check_plugins()

# ä¾èµ–æ£€æŸ¥
check_dependencies()

# ç”Ÿæˆå¥åº·æŠ¥å‘Š
generate_health_report()
```

### 5.4 å¤‡ä»½æ¢å¤æœåŠ¡ (lib_backup.sh)

#### åŠŸèƒ½èŒè´£
- åˆ›å»ºé…ç½®å¤‡ä»½
- åˆ—å‡ºå¯ç”¨å¤‡ä»½
- æ¢å¤é…ç½®
- æ¸…ç†æ—§å¤‡ä»½

#### æ ¸å¿ƒå‡½æ•°

```bash
# åˆ›å»ºå¤‡ä»½
create_backup(description)

# åˆ—å‡ºæ‰€æœ‰å¤‡ä»½
list_backups()

# æ¢å¤å¤‡ä»½
restore_backup(backup_id)

# åˆ é™¤å¤‡ä»½
delete_backup(backup_id)

# æ¸…ç†æ—§å¤‡ä»½ (ä¿ç•™æœ€è¿‘Nä¸ª)
cleanup_old_backups(keep_count)
```

---

## 6. APIæ¥å£è®¾è®¡

### 6.1 å‘½ä»¤è¡Œæ¥å£

#### ä¸»å‘½ä»¤: zsh_config_manager.sh

```bash
# æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬ä¿¡æ¯
./scripts/zsh_config_manager.sh version

# æ£€æŸ¥å¹¶æ‰§è¡Œè¿ç§»
./scripts/zsh_config_manager.sh migrate [--dry-run]

# æ‰§è¡Œå¥åº·æ£€æŸ¥
./scripts/zsh_config_manager.sh health [--verbose]

# åˆ›å»ºå¤‡ä»½
./scripts/zsh_config_manager.sh backup [--description "æè¿°"]

# åˆ—å‡ºå¤‡ä»½
./scripts/zsh_config_manager.sh list-backups

# æ¢å¤å¤‡ä»½
./scripts/zsh_config_manager.sh restore <backup-id>

# å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
./scripts/zsh_config_manager.sh rollback <version>

# æ˜¾ç¤ºè¿ç§»å†å²
./scripts/zsh_config_manager.sh history

# éªŒè¯é…ç½®
./scripts/zsh_config_manager.sh validate

# æ˜¾ç¤ºå¸®åŠ©
./scripts/zsh_config_manager.sh help
```

### 6.2 å‡½æ•°åº“æ¥å£

#### lib_version.sh

```bash
# ä½¿ç”¨ç¤ºä¾‹
source scripts/lib_version.sh

# è·å–å½“å‰ç‰ˆæœ¬
current_version=$(get_current_version)

# æ£€æŸ¥æ˜¯å¦éœ€è¦è¿ç§»
if needs_migration; then
    echo "éœ€è¦æ‰§è¡Œè¿ç§»"
fi

# æ¯”è¾ƒç‰ˆæœ¬
if compare_versions "2.2.0" "2.1.0"; then
    echo "2.2.0 > 2.1.0"
fi
```

#### lib_migration.sh

```bash
# ä½¿ç”¨ç¤ºä¾‹
source scripts/lib_migration.sh

# è·å–å¾…æ‰§è¡Œè¿ç§»
pending=$(get_pending_migrations)

# æ‰§è¡Œæ‰€æœ‰è¿ç§»
run_migrations

# å›æ»šæœ€åä¸€æ¬¡è¿ç§»
rollback_migration "002_add_template_system"
```

---

## 7. å®æ–½è®¡åˆ’

### 7.1 é˜¶æ®µåˆ’åˆ†

#### é˜¶æ®µ 1: åŸºç¡€è®¾æ–½ (ç¬¬1å‘¨)

**ç›®æ ‡**: å»ºç«‹ç‰ˆæœ¬ç®¡ç†å’Œæ•°æ®æ¨¡å‹åŸºç¡€

**ä»»åŠ¡æ¸…å•**:
- [ ] åˆ›å»ºç›®å½•ç»“æ„
- [ ] å®ç° lib_version.sh
- [ ] åˆ›å»ºç‰ˆæœ¬æ–‡ä»¶æ ¼å¼
- [ ] ç¼–å†™ç‰ˆæœ¬ç®¡ç†æµ‹è¯•

**äº¤ä»˜ç‰©**:
- `scripts/lib_version.sh`
- `config/.zshrc.version`
- `tests/unit/test_version.sh`

**éªŒæ”¶æ ‡å‡†**:
- èƒ½å¤Ÿè¯»å–å’Œè®¾ç½®ç‰ˆæœ¬ä¿¡æ¯
- ç‰ˆæœ¬æ¯”è¾ƒåŠŸèƒ½æ­£å¸¸
- å•å…ƒæµ‹è¯•é€šè¿‡ç‡ 100%

#### é˜¶æ®µ 2: è¿ç§»ç³»ç»Ÿ (ç¬¬1-2å‘¨)

**ç›®æ ‡**: å®ç°é…ç½®è¿ç§»åŠŸèƒ½

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° lib_migration.sh
- [ ] åˆ›å»ºè¿ç§»è„šæœ¬æ¨¡æ¿
- [ ] ç¼–å†™ç¤ºä¾‹è¿ç§»è„šæœ¬
- [ ] å®ç°è¿ç§»å†å²è®°å½•
- [ ] ç¼–å†™è¿ç§»æµ‹è¯•

**äº¤ä»˜ç‰©**:
- `scripts/lib_migration.sh`
- `config/migrations/001_initial.sh`
- `config/migrations/002_add_template_system.sh`
- `tests/unit/test_migration.sh`

**éªŒæ”¶æ ‡å‡†**:
- èƒ½å¤Ÿæ£€æµ‹å¾…æ‰§è¡Œè¿ç§»
- è¿ç§»è„šæœ¬æ­£ç¡®æ‰§è¡Œ
- è¿ç§»å†å²æ­£ç¡®è®°å½•
- å¤±è´¥èƒ½å¤Ÿå›æ»š

#### é˜¶æ®µ 3: å¥åº·æ£€æŸ¥ (ç¬¬2å‘¨)

**ç›®æ ‡**: å®ç°é…ç½®å¥åº·æ£€æŸ¥

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° lib_health.sh
- [ ] å®ç°è¯­æ³•æ£€æŸ¥
- [ ] å®ç°æ’ä»¶æ£€æŸ¥
- [ ] å®ç°ä¾èµ–æ£€æŸ¥
- [ ] ç”Ÿæˆå¥åº·æŠ¥å‘Š
- [ ] ç¼–å†™å¥åº·æ£€æŸ¥æµ‹è¯•

**äº¤ä»˜ç‰©**:
- `scripts/lib_health.sh`
- `tests/unit/test_health.sh`

**éªŒæ”¶æ ‡å‡†**:
- èƒ½å¤Ÿæ£€æµ‹é…ç½®è¯­æ³•é”™è¯¯
- èƒ½å¤Ÿæ£€æµ‹æ’ä»¶é—®é¢˜
- èƒ½å¤Ÿæ£€æµ‹ä¾èµ–ç¼ºå¤±
- ç”Ÿæˆæ¸…æ™°çš„å¥åº·æŠ¥å‘Š

#### é˜¶æ®µ 4: å¤‡ä»½æ¢å¤ (ç¬¬2-3å‘¨)

**ç›®æ ‡**: å®ç°é…ç½®å¤‡ä»½å’Œæ¢å¤

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° lib_backup.sh
- [ ] å®ç°å¤‡ä»½åˆ›å»º
- [ ] å®ç°å¤‡ä»½åˆ—è¡¨
- [ ] å®ç°å¤‡ä»½æ¢å¤
- [ ] å®ç°å¤‡ä»½æ¸…ç†
- [ ] ç¼–å†™å¤‡ä»½æµ‹è¯•

**äº¤ä»˜ç‰©**:
- `scripts/lib_backup.sh`
- `tests/unit/test_backup.sh`

**éªŒæ”¶æ ‡å‡†**:
- èƒ½å¤Ÿåˆ›å»ºå®Œæ•´å¤‡ä»½
- èƒ½å¤Ÿåˆ—å‡ºæ‰€æœ‰å¤‡ä»½
- èƒ½å¤Ÿæ¢å¤ä»»æ„å¤‡ä»½
- è‡ªåŠ¨æ¸…ç†æ—§å¤‡ä»½

#### é˜¶æ®µ 5: ä¸»ç®¡ç†å·¥å…· (ç¬¬3å‘¨)

**ç›®æ ‡**: é›†æˆæ‰€æœ‰åŠŸèƒ½åˆ°ç»Ÿä¸€CLI

**ä»»åŠ¡æ¸…å•**:
- [ ] å®ç° zsh_config_manager.sh
- [ ] é›†æˆæ‰€æœ‰å­æ¨¡å—
- [ ] å®ç°å‘½ä»¤è¡Œå‚æ•°è§£æ
- [ ] æ·»åŠ å¸®åŠ©æ–‡æ¡£
- [ ] ç¼–å†™é›†æˆæµ‹è¯•

**äº¤ä»˜ç‰©**:
- `scripts/zsh_config_manager.sh`
- `tests/integration/test_config_manager.sh`
- `docs/CONFIG_MANAGER_GUIDE.md`

**éªŒæ”¶æ ‡å‡†**:
- æ‰€æœ‰å‘½ä»¤æ­£å¸¸å·¥ä½œ
- å¸®åŠ©æ–‡æ¡£å®Œæ•´
- é›†æˆæµ‹è¯•é€šè¿‡
- ç”¨æˆ·æ–‡æ¡£æ¸…æ™°

#### é˜¶æ®µ 6: æ–‡æ¡£å’Œå‘å¸ƒ (ç¬¬3å‘¨)

**ç›®æ ‡**: å®Œå–„æ–‡æ¡£å¹¶å‘å¸ƒ

**ä»»åŠ¡æ¸…å•**:
- [ ] ç¼–å†™ç”¨æˆ·æŒ‡å—
- [ ] ç¼–å†™å¼€å‘è€…æ–‡æ¡£
- [ ] æ›´æ–° CHANGELOG.md
- [ ] æ›´æ–° README.md
- [ ] åˆ›å»ºå‘å¸ƒè¯´æ˜

**äº¤ä»˜ç‰©**:
- `docs/CONFIG_LIFECYCLE_GUIDE.md`
- `docs/DEVELOPER_GUIDE.md`
- æ›´æ–°çš„ CHANGELOG.md
- å‘å¸ƒè¯´æ˜

**éªŒæ”¶æ ‡å‡†**:
- æ–‡æ¡£å®Œæ•´æ¸…æ™°
- ç¤ºä¾‹ä»£ç å¯è¿è¡Œ
- å‘å¸ƒè¯´æ˜è¯¦ç»†

### 7.2 æ—¶é—´çº¿

```
Week 1:  [====åŸºç¡€è®¾æ–½====][==è¿ç§»ç³»ç»Ÿ==]
Week 2:  [==è¿ç§»ç³»ç»Ÿ==][==å¥åº·æ£€æŸ¥==][==å¤‡ä»½æ¢å¤==]
Week 3:  [==å¤‡ä»½æ¢å¤==][==ä¸»ç®¡ç†å·¥å…·==][==æ–‡æ¡£å‘å¸ƒ==]
```

---

## 8. æµ‹è¯•ç­–ç•¥

### 8.1 å•å…ƒæµ‹è¯•

**æµ‹è¯•æ–‡ä»¶ç»“æ„**:
```
tests/unit/
â”œâ”€â”€ test_version.sh          # ç‰ˆæœ¬ç®¡ç†æµ‹è¯•
â”œâ”€â”€ test_migration.sh        # è¿ç§»ç®¡ç†æµ‹è¯•
â”œâ”€â”€ test_health.sh           # å¥åº·æ£€æŸ¥æµ‹è¯•
â””â”€â”€ test_backup.sh           # å¤‡ä»½æ¢å¤æµ‹è¯•
```

**æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡**: > 80%

### 8.2 é›†æˆæµ‹è¯•

**æµ‹è¯•åœºæ™¯**:
1. å®Œæ•´å®‰è£…æµç¨‹æµ‹è¯•
2. ç‰ˆæœ¬å‡çº§æµç¨‹æµ‹è¯•
3. é…ç½®è¿ç§»æµç¨‹æµ‹è¯•
4. é”™è¯¯æ¢å¤æµç¨‹æµ‹è¯•

### 8.3 æ€§èƒ½æµ‹è¯•

**æ€§èƒ½æŒ‡æ ‡**:
- ç‰ˆæœ¬æ£€æŸ¥: < 50ms
- å¥åº·æ£€æŸ¥: < 500ms
- å¤‡ä»½åˆ›å»º: < 2s
- é…ç½®æ¢å¤: < 3s

### 8.4 å…¼å®¹æ€§æµ‹è¯•

**æµ‹è¯•å¹³å°**:
- Ubuntu 20.04, 22.04
- macOS 12, 13, 14
- Docker å®¹å™¨ç¯å¢ƒ

---

## 9. ä»£ç æ¨¡æ¿

### 9.1 è¿ç§»è„šæœ¬æ¨¡æ¿

**æ–‡ä»¶**: `config/migrations/XXX_description.sh`

```bash
#!/bin/bash
# Migration: XXX_description
# Version: X.X.X -> X.X.X
# Date: YYYY-MM-DD
# Description: ç®€çŸ­æè¿°è¿™ä¸ªè¿ç§»åšä»€ä¹ˆ

set -e

# è¿ç§»å‰æ£€æŸ¥
pre_check() {
    echo "æ‰§è¡Œè¿ç§»å‰æ£€æŸ¥..."
    # æ·»åŠ æ£€æŸ¥é€»è¾‘
    return 0
}

# æ‰§è¡Œè¿ç§»
migrate() {
    echo "æ‰§è¡Œè¿ç§»..."
    
    # ç¤ºä¾‹: æ·»åŠ æ–°é…ç½®
    # echo "æ–°é…ç½®å†…å®¹" >> ~/.zshrc
    
    # ç¤ºä¾‹: ä¿®æ”¹ç°æœ‰é…ç½®
    # sed -i 's/old/new/g' ~/.zshrc
    
    return 0
}

# å›æ»šè¿ç§»
rollback() {
    echo "å›æ»šè¿ç§»..."
    # æ·»åŠ å›æ»šé€»è¾‘
    return 0
}

# è¿ç§»åéªŒè¯
post_check() {
    echo "æ‰§è¡Œè¿ç§»åéªŒè¯..."
    # æ·»åŠ éªŒè¯é€»è¾‘
    return 0
}

# ä¸»å‡½æ•°
main() {
    local action="${1:-migrate}"
    
    case "$action" in
        migrate)
            pre_check && migrate && post_check
            ;;
        rollback)
            rollback
            ;;
        *)
            echo "ç”¨æ³•: $0 {migrate|rollback}"
            exit 1
            ;;
    esac
}

main "$@"
```

### 9.2 æµ‹è¯•è„šæœ¬æ¨¡æ¿

**æ–‡ä»¶**: `tests/unit/test_example.sh`

```bash
#!/bin/bash
# Unit Test: Example Test
# Description: æµ‹è¯•ç¤ºä¾‹

# åŠ è½½æµ‹è¯•æ¡†æ¶
source "$(dirname "$0")/../lib/test_utils.sh"

# åŠ è½½è¢«æµ‹è¯•æ¨¡å—
source "$(dirname "$0")/../../scripts/lib_example.sh"

# æµ‹è¯•ç”¨ä¾‹ 1
test_example_function() {
    local result
    result=$(example_function "input")
    
    assert_equals "expected" "$result" "æµ‹è¯•ç¤ºä¾‹å‡½æ•°"
}

# æµ‹è¯•ç”¨ä¾‹ 2
test_example_error_handling() {
    local result
    result=$(example_function "" 2>&1)
    
    assert_contains "error" "$result" "æµ‹è¯•é”™è¯¯å¤„ç†"
}

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
run_tests() {
    test_example_function
    test_example_error_handling
}

# ä¸»å‡½æ•°
main() {
    echo "è¿è¡Œå•å…ƒæµ‹è¯•: Example"
    run_tests
    print_test_summary
}

main "$@"
```

---

## 10. é£é™©å’Œç¼“è§£æªæ–½

### 10.1 æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| è¿ç§»è„šæœ¬å¤±è´¥å¯¼è‡´é…ç½®æŸå | é«˜ | ä¸­ | è¿ç§»å‰è‡ªåŠ¨å¤‡ä»½ï¼Œå¤±è´¥è‡ªåŠ¨å›æ»š |
| ç‰ˆæœ¬æ£€æµ‹ä¸å‡†ç¡® | ä¸­ | ä½ | å®Œå–„æµ‹è¯•ï¼Œå¤šåœºæ™¯éªŒè¯ |
| æ€§èƒ½å½±å“å¯åŠ¨é€Ÿåº¦ | ä¸­ | ä½ | å¼‚æ­¥å¥åº·æ£€æŸ¥ï¼Œç¼“å­˜ç‰ˆæœ¬ä¿¡æ¯ |
| è·¨å¹³å°å…¼å®¹æ€§é—®é¢˜ | ä¸­ | ä¸­ | ä½¿ç”¨ lib_platform_compat.sh |

### 10.2 ç”¨æˆ·ä½“éªŒé£é™©

| é£é™© | å½±å“ | æ¦‚ç‡ | ç¼“è§£æªæ–½ |
|------|------|------|----------|
| ç”¨æˆ·ä¸ç†è§£æ–°åŠŸèƒ½ | ä¸­ | é«˜ | è¯¦ç»†æ–‡æ¡£ï¼Œäº¤äº’å¼å¼•å¯¼ |
| è¿ç§»è¿‡ç¨‹ä¸­æ–­ç”¨æˆ·å·¥ä½œ | é«˜ | ä½ | æä¾›é™é»˜æ¨¡å¼ï¼Œåå°æ‰§è¡Œ |
| é”™è¯¯ä¿¡æ¯ä¸æ¸…æ™° | ä½ | ä¸­ | å‹å¥½çš„é”™è¯¯æç¤ºå’Œä¿®å¤å»ºè®® |

---

## 11. æˆåŠŸæ ‡å‡†

### 11.1 åŠŸèƒ½å®Œæ•´æ€§
- âœ… æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å®ç°
- âœ… æ‰€æœ‰å‘½ä»¤æ­£å¸¸å·¥ä½œ
- âœ… é”™è¯¯å¤„ç†å®Œå–„

### 11.2 è´¨é‡æ ‡å‡†
- âœ… å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- âœ… é›†æˆæµ‹è¯•é€šè¿‡ç‡ 100%
- âœ… ä»£ç æ³¨é‡Šè¦†ç›–ç‡ > 80%

### 11.3 æ€§èƒ½æ ‡å‡†
- âœ… ç‰ˆæœ¬æ£€æŸ¥ < 50ms
- âœ… å¥åº·æ£€æŸ¥ < 500ms
- âœ… ä¸å½±å“ ZSH å¯åŠ¨é€Ÿåº¦

### 11.4 ç”¨æˆ·ä½“éªŒæ ‡å‡†
- âœ… æ–°æ‰‹ 30 åˆ†é’Ÿå†…ä¸Šæ‰‹
- âœ… æ–‡æ¡£å®Œæ•´æ¸…æ™°
- âœ… é”™è¯¯æç¤ºå‹å¥½

---

## 12. ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¼€å§‹ (ä»Šå¤©)
1. åˆ›å»ºç›®å½•ç»“æ„
2. å®ç° lib_version.sh åŸºç¡€åŠŸèƒ½
3. ç¼–å†™ç¬¬ä¸€ä¸ªå•å…ƒæµ‹è¯•

### æœ¬å‘¨å®Œæˆ
1. å®Œæˆé˜¶æ®µ 1: åŸºç¡€è®¾æ–½
2. å¼€å§‹é˜¶æ®µ 2: è¿ç§»ç³»ç»Ÿ

### éœ€è¦çš„èµ„æº
- å¼€å‘æ—¶é—´: 2-3 å‘¨
- æµ‹è¯•ç¯å¢ƒ: Ubuntu + macOS
- ä»£ç å®¡æŸ¥: 1-2 äºº

---

## é™„å½• A: å‚è€ƒèµ„æ–™

### ä¸šç•Œæœ€ä½³å®è·µ
- [Flyway Database Migrations](https://flywaydb.org/)
- [Liquibase](https://www.liquibase.org/)
- [Semantic Versioning](https://semver.org/)
- [Git Version Control](https://git-scm.com/)

### ç›¸å…³æ–‡æ¡£
- `docs/management/PLANNING.md`
- `CHANGELOG.md`
- `OPTIMIZATION_RECOMMENDATIONS_V2.md`

---

**æ–‡æ¡£ç»“æŸ**

*å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤è€…*
